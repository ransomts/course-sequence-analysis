[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "course sequence analysis",
    "section": "",
    "text": "Preface\nThis project is looking at the effect of course sequencing on student graduation in higher education."
  },
  {
    "objectID": "10-intro-to-midfield.html#which-cips-have-the-most-time-in-program",
    "href": "10-intro-to-midfield.html#which-cips-have-the-most-time-in-program",
    "title": "1  Introduction to midfield",
    "section": "1.1 which cips have the most time in program?",
    "text": "1.1 which cips have the most time in program?\nokay so we’ve decided which cip code set we’re looking at! Great!\nLets see some graphs describing our data within that set. Which cips are the most represented?\n\n\nCode\nmost_represented_majors &lt;- term %&gt;% \n  select(mcid, cip6) %&gt;% \n  filter(cip6 %in% cips_of_interest) %&gt;% \n  select(cip6) %&gt;% \n  arrange(cip6) %&gt;% \n  group_by(cip6) %&gt;% \n  summarise(count = n()) %&gt;% \n  arrange(-count) \n\nmrm_plot &lt;- most_represented_majors %&gt;% \n  ggbarplot(x = \"cip6\", y = \"count\") + rotate_x_text(45)\nggexport(mrm_plot, filename = \"figures/most_represented_majors.png\", verbose = FALSE)\nknitr::include_graphics(\"figures/most_represented_majors.png\")\n\n\n\n\n\n\n\nCode\nmost_represented_major &lt;- most_represented_majors %&gt;% \n  head(1) %&gt;% \n  pull(cip6)\n\n# make a list of students who obtained this degree\nstudents_who_graduated_major &lt;- degree %&gt;% \n  filter(cip6 == most_represented_major) %&gt;% \n  select(mcid) %&gt;% \n  unique() %&gt;% \n  pull(mcid)\n\n# courses taken by students in most represented major\ncourses_taken &lt;- course %&gt;%\n  filter(mcid %in% students_who_graduated_major) %&gt;%\n  mutate(an = str_c(abbrev, \" \", number)) %&gt;%\n  select(an) %&gt;%\n  group_by(an) %&gt;% \n  summarise(count = n()) %&gt;%\n  arrange(-count)\n\ncourses_taken_plot &lt;- courses_taken %&gt;%\n  head(20) %&gt;%\n  ggbarplot(x = \"an\", y = \"count\") + rotate_x_text(45)\nggexport(courses_taken_plot, filename = \"figures/courses_taken.png\", verbose = FALSE)\nknitr::include_graphics(\"figures/courses_taken.png\")\n\n\n\n\n\nMake a stacked bar plot to break down which relative semester each course was taken\n\n\nCode\ncompute_semester_indicies &lt;- function(single_student_record) {\n  bar &lt;- single_student_record %&gt;% \n    tibble() %&gt;% \n    mutate(term_course = as_factor(term_course)) %&gt;% \n    mutate(semester_taken = as.integer(term_course)) %&gt;% \n    list()\n  return(bar)\n}\n\n# this is the continuous interpretation\nwhen_courses_were_taken_discrete &lt;- course %&gt;%\n  filter(mcid %in% students_who_graduated_major) %&gt;%\n  mutate(course = str_c(abbrev, \" \", number), \n         mcid, term_course) %&gt;%\n  select(mcid, course, term_course) %&gt;%\n  nest_by(mcid) %&gt;% \n  mutate(data = compute_semester_indicies(data)) %&gt;% \n  unnest(cols = c(data)) %&gt;% ungroup(mcid) %&gt;% \n  select(course, semester_taken)\n\n# this summarize converts our interpretation to categorical\nwhen_courses_were_taken &lt;- when_courses_were_taken_discrete %&gt;%\n  group_by_all() %&gt;% \n  summarise(COUNT = n()) %&gt;%\n  ungroup()\n\n\n`summarise()` has grouped output by 'course'. You can override using the\n`.groups` argument.\n\n\nCode\ntotal_counts &lt;- when_courses_were_taken %&gt;% \n  group_by(course) %&gt;% \n  summarise(total_count = sum(COUNT)) %&gt;% \n  ungroup()\n\nwhen_courses_were_taken &lt;- left_join(when_courses_were_taken,\n                                       total_counts, by = \"course\") %&gt;% \n  arrange(-total_count) %&gt;% \n  mutate(semester_taken = as_factor(semester_taken))\n\n\nwhen_bio_courses_were_taken &lt;- when_courses_were_taken %&gt;%\n  filter(grepl(\"BIO\", course)) \n\n\n\n\nCode\n# most taken courses stacked by what sequence position they were in\nwhen_courses_were_taken_plot &lt;- when_courses_were_taken %&gt;% \n  filter(total_count &gt; 100) %&gt;%\n  arrange(-COUNT) %&gt;% \n  head(50) %&gt;% \n  ggbarplot(x = \"course\", \n            y = \"COUNT\", \n            fill = \"semester_taken\") + rotate_x_text(45)\nggexport(when_courses_were_taken_plot,\n         filename = \"figures/when_courses_were_taken_barplot.png\", verbose = FALSE)\nknitr::include_graphics(\"figures/when_courses_were_taken_barplot.png\")\n\n\n\n\n\nCode\n# courses with high variation of sequence position\nwhen_courses_were_taken_barplot &lt;- when_courses_were_taken %&gt;%\n  select(course) %&gt;%\n  group_by(course) %&gt;% \n  summarize(n = n()) %&gt;%\n  ungroup() %&gt;% \n  arrange(-n) %&gt;%\n  head(20) %&gt;%\n  ggbarplot(y = \"course\", x = \"n\",\n            title = \"Number of different sequence positions per course\") + rotate_x_text(45)\n\n\nStoring counts in `nn`, as `n` already present in input\nℹ Use `name = \"new_name\"` to pick a new name.\n\n\nCode\nggexport(when_courses_were_taken_barplot, filename = \"figures/when_courses_were_taken.png\", verbose = FALSE)\nknitr::include_graphics(\"figures/when_courses_were_taken.png\")\n\n\n\n\n\nCode\nhighly_taken_classes &lt;- total_counts %&gt;% \n  arrange(-total_count) %&gt;% head(10)\n\nwhen_courses_were_taken_discrete %&gt;% \n  filter(course %in% highly_taken_classes$course & semester_taken &lt; 10) %&gt;%\n  ggviolin(x = \"course\", y = \"semester_taken\") +\n  rotate_x_text(45) + \n  grids() -&gt; p\np &lt;- ggpar(p, yticks.by = 1)\nggexport(p, filename = \"figures/when_courses_taken_violin.png\", verbose = FALSE)\nknitr::include_graphics(\"figures/when_courses_taken_violin.png\")"
  },
  {
    "objectID": "20-course-graphs.html#collection-of-utility-functions",
    "href": "20-course-graphs.html#collection-of-utility-functions",
    "title": "2  Course Graphs",
    "section": "2.1 collection of utility functions",
    "text": "2.1 collection of utility functions\n\n\nCode\ndid_student_graduate &lt;- function(mcid) {\n    return(degree %&gt;%\n        filter(mcid == mcid) %&gt;%\n        nrow() &gt; 0)\n}\n# make a table of the courses the student took by semester\nformat_courses &lt;- function(single_student) {\n    transcript_summary &lt;- single_student$data[[1]] %&gt;%\n        group_by(term_course) %&gt;%\n        mutate(p = str_c(abbrev, number, sep = \" \")) %&gt;%\n        summarize(label = paste(p, collapse = \"\\n\")) %&gt;%\n        ungroup() %&gt;%\n        select(label)\n    return(transcript_summary)\n}\n# this is a version that can be passed into a mutate statement TODO integrate\n# this with the non-vectorized version with a input variable check\nvectorized_format_courses &lt;- function(data) {\n    transcript_summary &lt;- data %&gt;%\n        group_by(term_course) %&gt;%\n        mutate(p = str_c(abbrev, number, sep = \" \")) %&gt;%\n        summarize(label = paste(p, collapse = \"\\n\")) %&gt;%\n        ungroup() %&gt;%\n        select(label)\n    return(list(transcript_summary))\n}\ncluster_copy(cluster, \"vectorized_format_courses\")"
  },
  {
    "objectID": "20-course-graphs.html#sampling-student-course-sequences",
    "href": "20-course-graphs.html#sampling-student-course-sequences",
    "title": "2  Course Graphs",
    "section": "2.2 Sampling student course sequences",
    "text": "2.2 Sampling student course sequences\nLet’s pull out a couple student course paths to take a look at:\n\n\nCode\n# convert to tibble\ncourse &lt;- tibble(course) %&gt;%\n    select(mcid, abbrev, number, term_course) %&gt;%\n    nest_by(mcid)\nstudents_of_interest &lt;- degree %&gt;%\n    filter(cip6 %in% cips_of_interest) %&gt;%\n    select(mcid)\nstudent_sequences_of_interest &lt;- course %&gt;%\n    filter(mcid %in% students_of_interest$mcid)\n\nsingle_student_mcid &lt;- student_sequences_of_interest %&gt;%\n    pull(mcid) %&gt;%\n    getElement(1)\nsingle_student_b_mcid &lt;- student_sequences_of_interest %&gt;%\n    pull(mcid) %&gt;%\n    getElement(2)\n\nsingle_student &lt;- student_sequences_of_interest %&gt;%\n    filter(mcid == single_student_mcid)\nsingle_student_b &lt;- student_sequences_of_interest %&gt;%\n    filter(mcid == single_student_b_mcid)\n\nsmall_sample &lt;- student_sequences_of_interest %&gt;%\n    head(10)\nsingle_student_sequence &lt;- format_courses(single_student)\nsingle_student_sequence_b &lt;- format_courses(single_student_b)"
  },
  {
    "objectID": "20-course-graphs.html#visualizing-a-students-course-sequence",
    "href": "20-course-graphs.html#visualizing-a-students-course-sequence",
    "title": "2  Course Graphs",
    "section": "2.3 Visualizing a student’s course sequence",
    "text": "2.3 Visualizing a student’s course sequence\n\n2.3.1 Student level unit of analysis\n\n\nCode\nmake_student_graph &lt;- function(single_student_sequence) {\n\n    make_edges &lt;- function(single_student_sequence) {\n        number_semesters &lt;- nrow(single_student_sequence)\n        return(data.frame(from = seq(number_semesters - 1), to = seq(2, number_semesters)))\n    }\n    make_nodes &lt;- function(single_student_sequence) {\n        number_semesters &lt;- nrow(single_student_sequence)\n        nodes &lt;- data.frame(id = seq(number_semesters), shape = \"box\")\n        return(cbind(nodes, single_student_sequence))\n    }\n\n    g &lt;- NULL\n    g$nodes &lt;- make_nodes(single_student_sequence)\n    g$edges &lt;- make_edges(single_student_sequence)\n    return(g)\n}\n\n\n\n\nCode\n# interactive simple student sequence\ns &lt;- single_student_sequence %&gt;%\n    make_student_graph()\nvisNetwork(s$nodes, s$edges, height = \"500px\", width = \"100%\") %&gt;%\n    visInteraction(navigationButtons = TRUE) %&gt;%\n    visEdges(arrows = \"to\") %&gt;%\n    visExport()"
  },
  {
    "objectID": "20-course-graphs.html#course-level-unit-of-analysis",
    "href": "20-course-graphs.html#course-level-unit-of-analysis",
    "title": "2  Course Graphs",
    "section": "2.4 Course level unit of analysis",
    "text": "2.4 Course level unit of analysis\n\n\nCode\nmake_course_graph &lt;- function(single_student_record) {\n\n    make_course_nodes &lt;- function(data) {\n        nodes &lt;- data %&gt;%\n            mutate(node_id = row_number(), course = str_c(abbrev, \" \", number), term_course = as.integer(as_factor(term_course))) %&gt;%\n            select(-abbrev, -number)\n        return(nodes)\n    }\n\n    make_course_edges &lt;- function(data) {\n        # LOTS of ways to speed this up\n        nodes &lt;- make_course_nodes(data)\n\n        edges &lt;- NULL\n        for (i in seq(max(nodes$term_course) - 1)) {\n            previous_course_indicies &lt;- nodes %&gt;%\n                select(term_course, node_id) %&gt;%\n                nest_by(term_course) %&gt;%\n                getElement(2) %&gt;%\n                getElement(i) %&gt;%\n                pull()\n            subsequent_course_indicies &lt;- nodes %&gt;%\n                select(term_course, node_id) %&gt;%\n                nest_by(term_course) %&gt;%\n                getElement(2) %&gt;%\n                getElement(i + 1) %&gt;%\n                pull()\n            if (is.null(edges)) {\n                edges &lt;- expand_grid(previous_course_indicies, subsequent_course_indicies)\n            } else {\n                edges &lt;- rbind(edges, expand_grid(previous_course_indicies, subsequent_course_indicies))\n            }\n        }\n        edges %&lt;&gt;%\n            rename(from = previous_course_indicies, to = subsequent_course_indicies)\n        return(edges)\n    }\n\n    n &lt;- make_course_nodes(single_student_record$data[[1]]) %&gt;%\n        select(course)\n    e &lt;- make_course_edges(single_student_record$data[[1]])\n    return(tbl_graph(nodes = n, edges = e))\n}\nmake_course_graph_vectorized &lt;- function(data) {\n\n    make_course_nodes &lt;- function(data) {\n        nodes &lt;- data %&gt;%\n            mutate(node_id = row_number(), course = str_c(abbrev, \" \", number), term_course = as.integer(as_factor(term_course))) %&gt;%\n            select(-abbrev, -number)\n        return(nodes)\n    }\n\n    make_course_edges &lt;- function(data) {\n        # LOTS of ways to speed this up\n        nodes &lt;- make_course_nodes(data)\n\n        edges &lt;- NULL\n        for (i in seq(max(nodes$term_course) - 1)) {\n            previous_course_indicies &lt;- nodes %&gt;%\n                select(term_course, node_id) %&gt;%\n                nest_by(term_course) %&gt;%\n                getElement(2) %&gt;%\n                getElement(i) %&gt;%\n                pull()\n            subsequent_course_indicies &lt;- nodes %&gt;%\n                select(term_course, node_id) %&gt;%\n                nest_by(term_course) %&gt;%\n                getElement(2) %&gt;%\n                getElement(i + 1) %&gt;%\n                pull()\n            if (is.null(edges)) {\n                edges &lt;- expand_grid(previous_course_indicies, subsequent_course_indicies)\n            } else {\n                edges &lt;- rbind(edges, expand_grid(previous_course_indicies, subsequent_course_indicies))\n            }\n        }\n        edges %&lt;&gt;%\n            rename(from = previous_course_indicies, to = subsequent_course_indicies)\n        return(edges)\n    }\n\n    n &lt;- make_course_nodes(data) %&gt;%\n        select(course)\n    e &lt;- make_course_edges(data)\n    return(list(tbl_graph(nodes = n, edges = e)))\n}\ncluster_copy(cluster, \"make_course_graph_vectorized\")\n\n\n\n\nCode\ngraph_a &lt;- make_course_graph(single_student)\ngraph_b &lt;- make_course_graph(single_student_b)\ngraph_c &lt;- graph_join(graph_a, graph_b, by = join_by(course))\ngraph_d &lt;- bind_graphs(graph_a, graph_b)\nvis_graph_a &lt;- toVisNetworkData(graph_a)\nvis_graph_c &lt;- toVisNetworkData(graph_c)\nvis_graph_d &lt;- toVisNetworkData(graph_d)\n# a bunch of graphs fast igraph visIgraph(as.igraph(graph_c)) %&gt;%\n# visInteraction(navigationButtons = TRUE) %&gt;% visEdges(arrows = 'to') %&gt;%\n# visExport()\ng &lt;- vis_graph_a\n# g$nodes %&lt;&gt;% filter(str_detect(course, 'BIOL'))\ng$nodes %&lt;&gt;%\n    mutate(label = NULL, shape = \"box\") %&gt;%\n    rename(label = course)\n# slow, interactive igraph\nvisNetwork(g$nodes, g$edges, height = \"500px\", width = \"100%\") %&gt;%\n    visInteraction(navigationButtons = TRUE) %&gt;%\n    visEdges(arrows = \"to\") %&gt;%\n    visExport() %&gt;%\n    visPhysics(stabilization = TRUE)\n\n\n\n\n\n\nCode\ng &lt;- vis_graph_d\n# g$nodes %&lt;&gt;% filter(str_detect(course, 'BIOL'))\ng$nodes %&lt;&gt;%\n    mutate(label = NULL, shape = \"box\") %&gt;%\n    rename(label = course)\n# slow, interactive igraph\nvisNetwork(g$nodes, g$edges, height = \"500px\", width = \"100%\") %&gt;%\n    visInteraction(navigationButtons = TRUE) %&gt;%\n    visEdges(arrows = \"to\") %&gt;%\n    visExport() %&gt;%\n    visPhysics(stabilization = TRUE)\n\n\n\n\n\n\nCode\ng &lt;- vis_graph_c\n# g$nodes %&lt;&gt;% filter(str_detect(course, 'BIOL'))\ng$nodes %&lt;&gt;%\n    mutate(label = NULL, shape = \"box\") %&gt;%\n    rename(label = course)\n# slow, interactive igraph\nvisNetwork(g$nodes, g$edges, height = \"500px\", width = \"100%\") %&gt;%\n    visInteraction(navigationButtons = TRUE) %&gt;%\n    visEdges(arrows = \"to\") %&gt;%\n    visExport() %&gt;%\n    visPhysics(stabilization = TRUE)"
  },
  {
    "objectID": "20-course-graphs.html#compute-all-course-sequences",
    "href": "20-course-graphs.html#compute-all-course-sequences",
    "title": "2  Course Graphs",
    "section": "2.5 compute all course sequences",
    "text": "2.5 compute all course sequences\n\n2.5.1 EMPLOY THE CORES\n\n\nCode\nif (!file.exists(\"data/course_graphs.rds\")) {\n    unpartitioned_course &lt;- course\n    course %&lt;&gt;%\n        partition(cluster)\n    unpartitioned_sequences &lt;- student_sequences_of_interest\n    student_sequences_of_interest %&lt;&gt;%\n        partition(cluster)\n    unpartitioned_small_sample &lt;- small_sample\n    small_sample %&lt;&gt;%\n        partition(cluster)\n\n    tic()\n    student_sequences_of_interest %&lt;&gt;%\n        mutate(graphs = make_course_graph_vectorized(data)) %&gt;%\n        collect()\n    toc()\n    # write_rds(small_sample, file = 'data/small_sample_graphs.rds')\n    write_rds(student_sequences_of_interest, file = \"data/course_graphs.rds\")\n}\n\nstudent_sequences_of_interest &lt;- read_rds(\"data/course_graphs.rds\")"
  },
  {
    "objectID": "30-graph-properties.html#sample-some-data",
    "href": "30-graph-properties.html#sample-some-data",
    "title": "3  Graph Properties",
    "section": "3.1 Sample some data",
    "text": "3.1 Sample some data\nWe’ve previously computed the network graphs of a couple student, but lets just sample out a handful more for some visualizations here.\n\n\nCode\nsample_of_graphs &lt;- sample_n(course_graphs, 5)\n\n\n\n3.1.1 Vanilla visualization\nFor reference here’s a visualization with no colorings. It’s a real eyesore to me but hey it makes the other graphs look better by comparison, eh?\n\n\n\n\n\n\n\n\n3.1.2 Coloring some nodes\n\n\nCode\n# lets use a blue-red spectrum here to show our centrality\n# high values -&gt; red\n# low values -&gt; blue\npalette &lt;- diverging_hcl(100, palette = \"Blue-Red-3\")\ncolor_key &lt;- palette %&gt;% enframe() %&gt;% rename(index = name, color = value)\n\ncolored_vanilla_graph &lt;- vanilla_graph %&gt;% \n  activate(nodes) %&gt;% \n  mutate(color = case_when(\n    str_detect(course, \"BIO\") ~ palette[1],\n    str_detect(course, \"CHEM\") ~ palette[100],\n    .default = palette[50]))\n\nvisualize_graph(colored_vanilla_graph)"
  },
  {
    "objectID": "30-graph-properties.html#edge-ratios",
    "href": "30-graph-properties.html#edge-ratios",
    "title": "3  Graph Properties",
    "section": "3.2 Edge Ratios",
    "text": "3.2 Edge Ratios"
  },
  {
    "objectID": "30-graph-properties.html#centrality",
    "href": "30-graph-properties.html#centrality",
    "title": "3  Graph Properties",
    "section": "3.3 Centrality",
    "text": "3.3 Centrality\n\n\nCode\nnormalize2 &lt;- function(x, na.rm = T) (x  / max(x, na.rm = T))\n\ncentrality_graph &lt;- vanilla_graph %&gt;% \n  activate(nodes) %&gt;%\n  mutate(centrality = centrality_alpha()) %&gt;% \n  mutate(normalized_centrality_1 = centrality, \n         normalized_centrality_2 = centrality) %&gt;% \n  mutate_at('normalized_centrality_1', ~ scale(.)) %&gt;% \n  mutate_at('normalized_centrality_2', normalize2) %&gt;% \n  mutate(color_index = floor(normalized_centrality_2 * 100)) %&gt;% \n  mutate(color = NULL) %&gt;% \n  left_join(color_key, by = join_by(color_index == index)) %&gt;%\n  arrange(desc(centrality))\n\nvisualize_graph(centrality_graph)"
  },
  {
    "objectID": "30-graph-properties.html#flow",
    "href": "30-graph-properties.html#flow",
    "title": "3  Graph Properties",
    "section": "3.4 Flow",
    "text": "3.4 Flow"
  },
  {
    "objectID": "30-graph-properties.html#cycles",
    "href": "30-graph-properties.html#cycles",
    "title": "3  Graph Properties",
    "section": "3.5 Cycles",
    "text": "3.5 Cycles"
  }
]